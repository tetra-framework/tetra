{
  "version": 3,
  "sources": ["../../../js/tetra.core.js", "../../../js/tetra.js"],
  "sourcesContent": ["\nconst Tetra = {\n  ws: null,\n  pendingSubscriptions: new Map(), // Store subscriptions until WS is ready\n\n  init() {\n    Alpine.magic('static', () => Tetra.$static);\n    // Initialize WebSocket connection immediately, if in use\n    if(window.__tetra_useWebsockets) {\n      this.ensureWebSocketConnection();\n    }\n    // Handle initial messages passed from the server\n    if (window.__tetra_messages) {\n      this.handleInitialMessages(window.__tetra_messages);\n      delete window.__tetra_messages;\n    }\n  },\n  handleInitialMessages(messages) {\n    // We need to wait for Alpine components to be ready before dispatching events to them.\n    // However, since we use 'defer' for tetra.js and Alpine, they should be ready around the same time.\n    // To be safe, we can use Alpine.nextTick or a small timeout if needed, but \n    // usually dispatching on document should work if components listen there.\n    messages.forEach((message) => {\n      document.dispatchEvent(new CustomEvent('tetra:new-message', {\n        detail: message,\n        bubbles: true\n      }));\n    });\n  },\n  $static() {\n    return (path) => {\n      return window.__tetra_staticRoot + path;\n    }\n  },\n  // Add WebSocket management methods\n  ensureWebSocketConnection() {\n    if (!this.ws || this.ws.readyState === WebSocket.CLOSED) {\n      console.log(\"Connecting to Tetra WebSocket...\");\n      const ws_scheme = window.location.protocol === \"https:\" ? \"wss\" : \"ws\";\n      const ws_url = `${ws_scheme}://${window.location.host}/ws/tetra/`;\n      this.ws = new WebSocket(ws_url);\n\n      this.ws.onopen = () => {\n        console.debug('Tetra WebSocket connected');\n        // Process any pending subscriptions\n        this.pendingSubscriptions.forEach((data, componentId) => {\n          this.ws.send(JSON.stringify(data));\n        });\n        this.pendingSubscriptions.clear();\n      };\n\n      this.ws.onmessage = (event) => {\n        const data = JSON.parse(event.data);\n        // Dispatch to all reactive components\n        // document.dispatchEvent(new CustomEvent('tetra:push-message', {detail: data}));\n        this.handleWebsocketMessage(data);\n      };\n\n      this.ws.onclose = () => {\n        console.log('Tetra WebSocket disconnected');\n        // Attempt to reconnect after 3 seconds\n        setTimeout(() => {\n          this.ensureWebSocketConnection();\n        }, 3000);\n      };\n\n      this.ws.onerror = (error) => {\n        console.error('Tetra WebSocket error:', error);\n      };\n    }\n    return this.ws;\n  },\n  _get_component_by_id(component_id) {\n    // Find the component by ID and return it\n    const componentEl = document.querySelector(`[tetra-component-id=\"${component_id}\"]`);\n    if (!componentEl) {\n      console.error(`AlpineJs Component with ID ${component_id} not found.`);\n      return;\n    }\n    return Alpine.$data(componentEl);\n  },\n  _get_components_by_subscribe_group(group) {\n    // Find all components by subscribe topic and return them\n    // Find all elements with tetra-subscription attribute\n    const componentEls = document.querySelectorAll('[tetra-subscription]');\n\n    // Filter to only those that contain the topic as a separate value\n    const matchingEls = Array.from(componentEls).filter(el => {\n      const subscribeAttr = el.getAttribute('tetra-subscription');\n      const topics = subscribeAttr.split(',').map(t => t.trim());\n      return topics.includes(group);\n    });\n\n    return matchingEls.map(el => Alpine.$data(el));\n  },\n  handleWebsocketMessage(data) {\n    // This function centrally handles incoming websocket data and dispatches it to the\n    // corresponding methods, if necessary.\n    \n    let messageType;\n    let payload;\n    let metadata = {};\n\n    if (data.protocol !== \"tetra-1.0\") {\n      console.warn('Invalid or missing Tetra protocol in WebSocket message:', data);\n      return;\n    }\n\n    messageType = data.type;\n    payload = data.payload;\n    metadata = data.metadata || {};\n\n    switch (messageType) {\n      case 'subscription.response':\n        this.handleSubscriptionResponse(payload);\n        break;\n\n      case 'notify':\n        this.handleGroupNotify(payload);\n        break;\n\n      case 'component.update_data':\n        this.handleComponentUpdateData(payload);\n        break;\n\n      case 'component.remove':\n        this.handleComponentRemove(payload);\n        break;\n\n      default:\n        console.warn('Unknown WebSocket message type:', messageType, \":\", data);\n    }\n  },\n  handleSubscriptionResponse(event){\n    switch(event[\"status\"]) {\n      case \"subscribed\":\n        console.debug(\"Subscription to group\", event[\"group\"], \"successful.\")\n        document.dispatchEvent(new CustomEvent(`tetra:component-subscribed`,  {\n          detail: {\n            component: this,\n            group: event[\"group\"]\n          },\n        }))\n        break;\n      case \"unsubscribed\":\n        console.debug(\"Subscription to group\", event[\"group\"], \"redacted successfully.\")\n        document.dispatchEvent(new CustomEvent(`tetra:component-unsubscribed`,  {\n          detail: {\n            component: this,\n            group: event[\"group\"]\n          },\n        }))\n        break;\n      case \"resubscribed\":\n        console.debug(\"Re-subscription to group\", event[\"group\"], \"successful.\")\n        document.dispatchEvent(new CustomEvent(`tetra:component-resubscribed`,  {\n          detail: {\n            component: this,\n            group: event[\"group\"]\n          },\n        }))\n        break;\n      case \"error\":\n        console.error(\"Error subscribing component\", event[\"component_id\"], \"to group\", event[\"group\"], \":\", event[\"message\"])\n        document.dispatchEvent(new CustomEvent(`tetra:component-subscription-error`,  {\n          detail: {\n            component: this,\n            group: event[\"group\"],\n            message:event[\"message\"]\n          },\n        }))\n        break;\n      default:\n        console.debug(\"Subscription response faulty:\", event)\n    }\n  },\n  handleGroupNotify(event) {\n    /// Dispatch a custom event that was sent from the server as notification\n    const { group, event_name, data } = event;\n\n    // Dispatch group-specific event\n    document.dispatchEvent(new CustomEvent(event_name, {\n      detail: {\n        data,\n        group,\n      }\n    }));\n  },\n  handleComponentUpdateData(event) {\n    const { type, group, data } = event;\n    const components = this._get_components_by_subscribe_group(group);\n    // iter through components and update their data fields\n    components.forEach(component => component._updateData(data));\n\n  },\n  handleComponentRemove(event) {\n    const { type, group, component_id } = event;\n\n    const component = this._get_component_by_id(component_id)\n\n    if (component && component._removeComponent) {\n      component._removeComponent();\n    } else {\n      // Fallback: just remove the element using JavaScript.\n      // This does not dispatch the `tetra:component-before-remove` event,\n      // but at least the component vanishes... :-)\n      component.remove();\n      console.debug(\"Element with ID ${component_id} not identified as Alpine component, just removed it anyway.\");\n    }\n  },\n  sendWebSocketMessage(message) {\n    if (!this.ws) {\n      console.log(\"WebSocket is not connected. Cannot send message.\");\n      return\n    }\n    if (this.ws.readyState === WebSocket.OPEN) {\n      this.ws.send(JSON.stringify(message));\n    } else {\n      // Store subscription messages until connection is ready\n      if (message.type === 'subscribe' && message.component_id) {\n        this.pendingSubscriptions.set(message.component_id, message);\n      }\n      // Queue other messages\n      this.ws.addEventListener('open', () => {\n        this.ws.send(JSON.stringify(message));\n      }, { once: true });\n    }\n  },\n  alpineComponentMixins() {\n    return {\n      // Alpine.js lifecycle:\n      init() {\n        this.component_id = this.$el.getAttribute('tetra-component-id');\n        this.$dispatch('tetra:child-component-init', {component:  this});\n        // Set component ID attribute on DOM element for targeting\n        this.__initServerWatchers();\n\n        // Auto-subscribe if component is reactive\n        if (window.__tetra_useWebsockets && this.$el.hasAttribute('tetra-reactive')) {\n          Tetra.ensureWebSocketConnection();\n\n          // Handle dynamic subscriptions from template\n\n          const group = this.$el.getAttribute('tetra-subscription');\n          if (group) {\n            this._subscribe(group);\n          }\n        }\n\n        if (this.__initInner) {\n          this.__initInner();\n        }\n\n        this._handleAutofocus();\n\n        const addClassToExternalIndicators = () => {\n          // adds `tetra-indicator` class to all elements targeted with `t-indicator` attribute\n          const elementsWithIndicator = [this.$el, ...Array.from(this.$el.querySelectorAll('[t-indicator]'))]\n          elementsWithIndicator.forEach(el => {\n            const indicators = el.getAttribute('t-indicator')\n            if (indicators) {\n              // If an explicit selector is given, hide it and add marker class to find it later\n              document.querySelectorAll(indicators).forEach(indicator => {\n                if (indicator.getAttribute('hidden') === null) {\n                  // indicator.setAttribute('hidden', '');\n                  indicator.hidden = true;\n                }\n                indicator.classList.add('tetra-indicator-' + this.component_id);\n              });\n            }\n          });\n        };\n        addClassToExternalIndicators();\n        this.$el.addEventListener('tetra:component-updated', addClassToExternalIndicators);\n\n        const handleRequestEvent = (event, isBefore) => {\n          const triggerEl = event.detail.triggerEl || event.target;\n          const requestId = event.detail.requestId;\n\n          if (!this.$el.contains(triggerEl) && this.$el !== triggerEl) return;\n\n          if (!this.__activeRequests) {\n            this.__activeRequests = new Map();\n          }\n\n          if (isBefore) {\n            let triggerSelector = '';\n            if (triggerEl.id) {\n              triggerSelector = '#' + triggerEl.id;\n            }\n            this.__activeRequests.set(requestId, {\n              triggerSelector: triggerSelector,\n              indicatorSelector: triggerEl.getAttribute('t-indicator')\n            });\n          } else {\n            this.__activeRequests.delete(requestId);\n          }\n\n          const updateElementState = (el, reqId, isStart) => {\n            if (!el.__activeRequests) el.__activeRequests = new Set();\n            if (isStart) el.__activeRequests.add(reqId);\n            else el.__activeRequests.delete(reqId);\n            return el.__activeRequests.size > 0;\n          }\n\n          const hasActive = updateElementState(triggerEl, requestId, isBefore);\n          triggerEl.classList.toggle(\"tetra-request\", hasActive);\n\n          const selector = triggerEl.getAttribute('t-indicator');\n          if (selector) {\n            const localIndicators = Array.from(this.$el.querySelectorAll(selector))\n            const globalIndicators = Array.from(document.querySelectorAll('.tetra-indicator-' + this.component_id))\n\n            const allIndicators = new Set(localIndicators)\n            globalIndicators.forEach(el => {\n              if (el.matches(selector)) {\n                allIndicators.add(el)\n              }\n            })\n\n            allIndicators.forEach(el => {\n              const active = updateElementState(el, requestId, isBefore);\n              if (active) {\n                el.removeAttribute('hidden');\n                el.hidden = false;\n              } else {\n                el.setAttribute('hidden', '');\n                el.hidden = true;\n              }\n            })\n          }\n        };\n\n        const reapplyLoadingState = () => {\n          if (!this.__activeRequests || this.__activeRequests.size === 0) return;\n\n          this.__activeRequests.forEach((info, reqId) => {\n            if (info.triggerSelector) {\n              const triggers = this.$el.querySelectorAll(info.triggerSelector);\n              triggers.forEach(el => {\n                if (!el.__activeRequests) el.__activeRequests = new Set();\n                el.__activeRequests.add(reqId);\n                el.classList.add(\"tetra-request\");\n              });\n            }\n            if (info.indicatorSelector) {\n              const localIndicators = Array.from(this.$el.querySelectorAll(info.indicatorSelector))\n              const globalIndicators = Array.from(document.querySelectorAll('.tetra-indicator-' + this.component_id))\n\n              const allIndicators = new Set(localIndicators)\n              globalIndicators.forEach(el => {\n                if (el.matches(info.indicatorSelector)) {\n                  allIndicators.add(el)\n                }\n              })\n              \n              allIndicators.forEach(el => {\n                if (!el.__activeRequests) el.__activeRequests = new Set();\n                el.__activeRequests.add(reqId);\n                el.removeAttribute('hidden');\n                el.hidden = false;\n              });\n            }\n          });\n        };\n\n        this.$el.addEventListener(\"tetra:before-request\", (event) => handleRequestEvent(event, true));\n        this.$el.addEventListener(\"tetra:after-request\", (event) => handleRequestEvent(event, false));\n        this.$el.addEventListener('tetra:component-updated', reapplyLoadingState);\n      },\n      destroy() {\n        this.$dispatch('tetra:child-component-destroy', {component:  this});\n\n        // Unsubscribe from all group when component is destroyed\n        if (this.__subscribedGroups) {\n          this.__subscribedGroups.forEach(group => {\n            this._unsubscribe(group);\n          });\n        }\n\n        if (this.__destroyInner) {\n          this.__destroyInner();\n        }\n      },\n      // Tetra built ins:\n      _updateHtml(html) {\n        Alpine.morph(this.$root, html, {\n          updating(el, toEl, childrenOnly, skip) {\n            if (toEl.hasAttribute && toEl.hasAttribute('x-data-maintain') && el.hasAttribute && el.hasAttribute('x-data')) {\n              toEl.setAttribute('x-data', el.getAttribute('x-data'));\n              toEl.removeAttribute('x-data-maintain');\n            } else if (toEl.hasAttribute && toEl.hasAttribute('x-data-update') && el.hasAttribute && el.hasAttribute('x-data')) {\n              let data = Tetra.jsonDecode(toEl.getAttribute('x-data-update'));\n              let old_data = Tetra.jsonDecode(toEl.getAttribute('x-data-update-old'));\n              let comp = window.Alpine.$data(el);\n              for (const key in data) {\n                if (old_data.hasOwnProperty(key) && (old_data[key] !== comp[key])) {\n                  // If the data that was submitted to the server has since changed we don't overwrite it\n                  continue\n                }\n                comp[key] = data[key];\n              }\n              toEl.setAttribute('x-data', el.getAttribute('x-data'));\n              toEl.removeAttribute('x-data-update');\n            }\n          },\n          lookahead: true\n        });\n        this._handleAutofocus();\n        this.$dispatch('tetra:component-updated', { component: this });\n      },\n      _updateData(data) {\n        for (const key in data) {\n          this[key] = data[key];\n        }\n        // this._handleAutofocus(); // TODO: evaluate if this would make sense too\n        this.$dispatch('tetra:component-data-updated', { component: this });\n      },\n      _setValueByName(name, value){\n        // sets value to the input field with the given name\n        // This is especially useful for emptying a file field, as the browser doesn't do that on page refreshes.\n        let inputs = document.getElementsByName(name);\n        for (let i = 0; i < inputs.length; i++) {\n          inputs[i].value = value;\n        }\n      },\n      _removeComponent() {\n        this.$dispatch('tetra:component-before-remove', { component: this });\n        this.$root.remove();\n      },\n      _replaceComponent(html) {\n        this.$dispatch('tetra:component-before-remove', { component: this });\n        this.$root.insertAdjacentHTML('afterend', html);\n        this.$root.remove();\n        this.$dispatch('tetra:component-updated', { component: this });\n        this._handleAutofocus();\n      },\n      _redirect(url) {\n        document.location = url;\n      },\n      _dispatch(name, data) {\n        this.$dispatch(name, {\n          _component: this,\n          ...data\n        });\n      },\n      _pushUrl(url, replace=false) {\n        if(replace){\n          window.history.replaceState(null, '', url);\n        } else {\n          window.history.pushState(null, '', url);\n        }\n      },\n      _updateSearchParam(param, value) {\n        const url = new URL(window.location);\n        if (value) {\n          url.searchParams.set(param, value);\n        } else {\n          url.searchParams.delete(param);\n        }\n        window.history.pushState(null, \"\", url.toString());\n      },\n      _handleAutofocus() {\n        this.$nextTick(() => {\n          if (!this.$root) {\n            return;\n          }\n          const focus_el = this.$root.querySelector(\"[autofocus]\");\n          if (focus_el) {\n            focus_el.focus();\n          }\n        });\n      },\n\n      // Push notification methods\n      _subscribe(groupName, autoUpdate = true) {\n        if (!this.__subscribedGroups) {\n          this.__subscribedGroups = new Set();\n        }\n\n        this.__subscribedGroups.add(groupName);\n\n        return Tetra.sendWebSocketMessage({\n          type: 'subscribe',\n          group: groupName,\n          component_id: this.component_id,\n          component_class: this.componentName,\n          auto_update: autoUpdate\n        });\n      },\n\n      _unsubscribe(groupName) {\n        if (this.__subscribedGroups) {\n          this.__subscribedGroups.delete(groupName);\n        }\n\n        return Tetra.sendWebSocketMessage({\n          type: 'unsubscribe',\n          group: groupName,\n          component_id: this.component_id\n        });\n      },\n\n      _notifyGroup(groupName, eventName, data) {\n        return Tetra.sendWebSocketMessage({\n          type: 'notify',\n          group: groupName,\n          event_name: eventName,\n          data: data,\n          sender_id: this.component_id\n        });\n      },\n\n\n      // Tetra private:\n      __initServerWatchers() {\n        this.__serverMethods.forEach(item => {\n          if (item.watch) {\n            item.watch.forEach(propName => {\n              this.$watch(propName, async (value, oldValue) => {\n                await this[item.name](value, oldValue, propName);\n              })\n            })\n          }\n        })\n      },\n      __childComponents: {},\n      __rootBind: {\n        ['@tetra:child-component-init'](event) {\n          event.stopPropagation();\n          const comp = event.detail.component;\n          if (comp.key === this.key) {\n            return\n          }\n          if (comp.key) {\n            this.__childComponents[comp.key] = comp;\n          }\n          comp._parent = this;\n        },\n        ['@tetra:child-component-destroy'](event) {\n          event.stopPropagation();\n          const comp = event.detail.component;\n          if (comp.key === this.key) {\n            return\n          }\n          delete this.__childComponents[comp.key];\n          event.detail.component._parent = null;\n        }\n      }\n    }\n  },\n\n  makeServerMethods(serverMethods) {\n    const methods = {};\n    serverMethods.forEach((serverMethod) => {\n      var func = async function(...args) {\n        // TODO: ensure only one concurrent?\n        return await Tetra.callServerMethod(this, serverMethod.name, serverMethod.endpoint, args)\n      }\n      if (serverMethod.debounce) {\n        func = Tetra.debounce(func, serverMethod.debounce, serverMethod.debounce_immediate)\n      } else if (serverMethod.throttle) {\n        func = Tetra.throttle(func, serverMethod.throttle, {\n          leading: serverMethod.throttle_leading,\n          trailing: serverMethod.throttle_trailing\n        })\n      }\n      methods[serverMethod.name] = func;\n    })\n    return methods\n  },\n\n  makeAlpineComponent(componentName, script, serverMethods, serverProperties) {\n    Alpine.data(\n        componentName,\n        (initialDataJson) => {\n          const {init, destroy, ...script_rest} = script;\n          const initialData = Tetra.jsonDecode(initialDataJson);\n          const data = {\n            componentName,\n            __initInner: init,\n            __destroyInner: destroy,\n            __serverMethods: serverMethods,\n            __serverProperties: serverProperties,\n            ...(initialData || {}),\n            ...script_rest,\n            ...Tetra.makeServerMethods(serverMethods),\n            ...Tetra.alpineComponentMixins(),\n          }\n          return data\n        }\n    )\n  },\n\n  getStateWithChildren(component) {\n    const data = {}\n    component.__serverProperties.forEach((key) => {\n      data[key] = component[key]\n    })\n    const r = {\n      encrypted: component.__state,\n      data: data,\n      children: []\n    }\n    for (const key in component.__childComponents) {\n      const comp = component.__childComponents[key];\n      r.children.push(Tetra.getStateWithChildren(comp));\n    }\n    return r;\n  },\n\n  loadScript(src) {\n    return new Promise((resolve, reject) => {\n      const script = document.createElement('script');\n      script.src = src;\n      script.onload = resolve;\n      script.onerror = reject;\n      document.head.appendChild(script);\n    });\n  },\n\n  loadStyles(href) {\n    return new Promise((resolve, reject) => {\n      const link = document.createElement('link');\n      link.href = href;\n      link.rel  = 'stylesheet';\n      link.type = 'text/css';\n      link.onload = resolve;\n      link.onerror = reject;\n      document.head.appendChild(link);\n    });\n  },\n  getFilenameFromContentDisposition(contentDisposition) {\n    if (!contentDisposition) return null;\n\n    // First, try to get the filename* parameter (RFC 5987)\n    let matches = /filename\\*=([^']*)'([^']*)'([^;]*)/i.exec(contentDisposition);\n    if (matches) {\n      // Decode the UTF-8 encoded filename\n      try {\n        return decodeURIComponent(matches[3]);\n      } catch (e) {\n        console.warn('Error decoding filename:', e);\n      }\n    }\n    // Try to get the regular filename parameter\n    matches = /filename=[\"']?([^\"';\\n]*)[\"']?/i.exec(contentDisposition);\n    if (matches) {\n      return matches[1];\n    }\n    return null;\n  },\n\n  async handleServerMethodResponse(response, component) {\n    if (response.status === 200) {\n      const cd = response.headers.get('Content-Disposition')\n      if (cd?.startsWith(\"attachment\")) {\n        const a = document.createElement('a')\n        a.href = URL.createObjectURL(await response.blob())\n        a.download = this.getFilenameFromContentDisposition(cd)\n        a.click()\n        a.remove()\n        return;\n      }\n\n      const responseText = await response.text();\n      const respData = Tetra.jsonDecode(responseText);\n\n      let success = false;\n      let result = null;\n      let js = [];\n      let styles = [];\n      let messages = [];\n      let callbacks = [];\n\n      if (respData.protocol !== \"tetra-1.0\") {\n        throw new Error('Invalid or missing Tetra protocol in server response');\n      }\n\n      success = respData.success;\n      if (respData.payload) {\n        result = respData.payload.result;\n      }\n      if (respData.metadata) {\n        js = respData.metadata.js || [];\n        styles = respData.metadata.styles || [];\n        messages = respData.metadata.messages || [];\n        callbacks = respData.metadata.callbacks || [];\n\n        // Fast lane for redirects\n        const redirectCallback = callbacks.find(item =>\n            item.callback && item.callback.length === 1 && item.callback[0] === '_redirect'\n        );\n        if (redirectCallback && redirectCallback.args && redirectCallback.args.length > 0) {\n          document.location = redirectCallback.args[0];\n          return;\n        }\n      }\n      if (!success && respData.error) {\n        console.error(`Tetra method error [${respData.error.code}]: ${respData.error.message}`);\n        // Emit event for custom error handling\n        document.dispatchEvent(new CustomEvent('tetra:method-error', {\n          detail: {\n            component: component,\n            error: respData.error\n          }\n        }));\n      }\n\n      // handle Django messages and emit \"tetra:new-message\" for each one\n      if (messages) {\n        messages.forEach((message) => {\n          component.$dispatch('tetra:new-message', message)\n        })\n      }\n\n      if (success) {\n        let loadingResources = [];\n        js.forEach(src => {\n          if (!document.querySelector(`script[src=\"${CSS.escape(src)}\"]`)) {\n            loadingResources.push(Tetra.loadScript(src));\n          }\n        })\n        styles.forEach(src => {\n          if (!document.querySelector(`link[href=\"${CSS.escape(src)}\"]`)) {\n            loadingResources.push(Tetra.loadStyles(src));\n          }\n        })\n        await Promise.all(loadingResources);\n        if (callbacks) {\n          callbacks.forEach((item) => {\n            // iterate down path to callback\n            let obj = component;\n            item.callback.forEach((name, i) => {\n              if (i === item.callback.length-1) {\n                obj[name](...item.args);\n              } else {\n                obj = obj[name];\n              }\n            })\n          })\n        }\n        return result;\n      } else {\n        if (respData.error) {\n          throw new Error(`Error processing public method: ${respData.error.message}`);\n        }\n        throw new Error('Error processing public method');\n      }\n    } else {\n      throw new Error(`Server responded with an error ${response.status} (${response.statusText})`);\n    }\n  },\n\n  async callServerMethod(component, methodName, methodEndpoint, args) {\n    const requestId = Math.random().toString(36).substring(2, 15);\n    let component_state = Tetra.getStateWithChildren(component);\n    component_state.args = args || [];\n\n    const requestEnvelope = {\n      protocol: \"tetra-1.0\",\n      id: requestId,\n      type: \"call\",\n      payload: {\n        component_id: component.$el.getAttribute('tetra-component-id'),\n        method: methodName,\n        args: component_state.args,\n        state: component_state.data,\n        encrypted_state: component_state.encrypted,\n        children_state: component_state.children\n      }\n    };\n\n    let fetchPayload = {\n      method: 'POST',\n      headers: {\n        'T-Request': \"true\",\n        'T-Current-URL': document.location.href,\n        'X-CSRFToken': window.__tetra_csrfToken,\n      },\n      mode: 'same-origin',\n    }\n\n    let formData = new FormData();\n    let hasFiles = false;\n    for(const [key, value] of Object.entries(component_state.data)){\n      // TODO: handle multi-file uploads\n      if (value instanceof File) {\n        hasFiles = true;\n        // A file is not uploaded anyway, as the browser automatically deletes the data if submitted within a JSON.\n        // On the server, only an empty {} will arrive, so we can set it to {} anyway.\n        // In the protocol, we keep the original state, but when sending we might need to adjust.\n        requestEnvelope.payload.state[key] = {};\n        formData.append(key, value);\n        // TODO: prevent re-uploading of files that are already uploaded.\n      }\n    }\n\n    // check if FormData has *any* entry - and if not, send JSON request\n    if (hasFiles) {\n      formData.append('tetra_payload', Tetra.jsonEncode(requestEnvelope));\n      fetchPayload.body = formData;\n    } else {\n      fetchPayload.body = Tetra.jsonEncode(requestEnvelope)\n      fetchPayload.headers['Content-Type'] = 'application/json'\n    }\n    const triggerEl = component.$event ? component.$event.target : component.$el;\n    component.$dispatch('tetra:before-request', {\n      component: component,\n      triggerEl: triggerEl,\n      requestId: requestId\n    });\n    const response = await fetch(methodEndpoint, fetchPayload);\n    component.$dispatch('tetra:after-request', {\n      component: component,\n      triggerEl: triggerEl,\n      requestId: requestId\n    })\n    return await this.handleServerMethodResponse(response, component);\n  },\n\n  jsonReplacer(key, value) {\n    if (value instanceof Date) {\n      return {\n        __type: 'datetime',\n        value: value.toISOString(),\n      };\n    } else if (value instanceof Set) {\n      return {\n        __type: 'set',\n        value: Array.from(value)\n      };\n    }\n    // else if (value?.[0] instanceof File) {\n    //   return {\n    //     __type: 'file',\n    //     name: value[0].name,\n    //     value: value[0],\n    //     size: value[0].size,\n    //     content_type: value[0].type,\n    //   };\n    // }\n    return value;\n  },\n\n  jsonReviver(key, value) {\n    if (value && typeof value === 'object' && value.__type) {\n      if (value.__type === 'datetime') {\n        return new Date(value);\n      } else if (value.__type === 'set') {\n        return new Set(value);\n      }\n    }\n    return value\n  },\n\n  jsonEncode(obj) {\n    return JSON.stringify(obj, Tetra.jsonReplacer);\n  },\n\n  jsonDecode(s) {\n    return JSON.parse(s, Tetra.jsonReviver)\n  },\n\n  debounce(func, wait, immediate) {\n    var timeout\n    return function() {\n      var context = this, args = arguments\n      var later = function () {\n        timeout = null\n        if (!immediate) func.apply(context, args);\n      }\n      var callNow = immediate && !timeout;\n      clearTimeout(timeout);\n      timeout = setTimeout(later, wait);\n      if (callNow) func.apply(context, args);\n    }\n  },\n\n  throttle(func, wait, options) {\n    // From Underscore.js\n    // https://underscorejs.org\n    // (c) 2009-2022 Jeremy Ashkenas, Julian Gonggrijp, and DocumentCloud and\n    // Investigative Reporters & Editors\n    // Underscore may be freely distributed under the MIT license.\n    // --\n    // Returns a function, that, when invoked, will only be triggered at most once\n    // during a given window of time. Normally, the throttled function will run\n    // as much as it can, without ever going more than once per `wait` duration;\n    // but if you'd like to disable the execution on the leading edge, pass\n    // `{leading: false}`. To disable execution on the trailing edge, ditto.\n    var timeout, context, args, result;\n    var previous = 0;\n    if (!options) options = {};\n\n    var later = function() {\n      previous = options.leading === false ? 0 : Date.now();\n      timeout = null;\n      result = func.apply(context, args);\n      if (!timeout) context = args = null;\n    };\n\n    var throttled = function() {\n      var _now = Date.now();\n      if (!previous && options.leading === false) previous = _now;\n      var remaining = wait - (_now - previous);\n      context = this;\n      args = arguments;\n      if (remaining <= 0 || remaining > wait) {\n        if (timeout) {\n          clearTimeout(timeout);\n          timeout = null;\n        }\n        previous = _now;\n        result = func.apply(context, args);\n        if (!timeout) context = args = null;\n      } else if (!timeout && options.trailing !== false) {\n        timeout = setTimeout(later, remaining);\n      }\n      return result;\n    };\n\n    throttled.cancel = function() {\n      clearTimeout(timeout);\n      previous = 0;\n      timeout = context = args = null;\n    };\n\n    return throttled;\n  }\n\n}\n\nexport default Tetra;\n", "import Tetra from './tetra.core'\n\nwindow.Tetra = Tetra;\nwindow.document.addEventListener('alpine:init', () => {\n  Tetra.init();\n})\n"],
  "mappings": "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",
  "names": ["Tetra", "messages", "message", "path", "ws_url", "data", "componentId", "event", "error", "component_id", "componentEl", "group", "componentEls", "el", "t", "messageType", "payload", "metadata", "event_name", "type", "component", "addClassToExternalIndicators", "indicators", "indicator", "handleRequestEvent", "isBefore", "triggerEl", "requestId", "triggerSelector", "updateElementState", "reqId", "isStart", "hasActive", "selector", "localIndicators", "globalIndicators", "allIndicators", "reapplyLoadingState", "info", "html", "toEl", "childrenOnly", "skip", "old_data", "comp", "key", "name", "value", "inputs", "i", "url", "replace", "param", "focus_el", "groupName", "autoUpdate", "eventName", "item", "propName", "oldValue", "serverMethods", "methods", "serverMethod", "func", "args", "componentName", "script", "serverProperties", "initialDataJson", "init", "destroy", "script_rest", "initialData", "r", "src", "resolve", "reject", "href", "link", "contentDisposition", "matches", "e", "response", "cd", "a", "responseText", "respData", "success", "result", "js", "styles", "callbacks", "redirectCallback", "loadingResources", "obj", "methodName", "methodEndpoint", "component_state", "requestEnvelope", "fetchPayload", "formData", "hasFiles", "s", "wait", "immediate", "timeout", "context", "later", "callNow", "options", "previous", "throttled", "_now", "remaining", "tetra_core_default", "tetra_core_default"]
}
